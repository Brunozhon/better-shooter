<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplayer Game with Weapon Unlocks, Inventory & Random Items</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; background: #87CEEB; }
        .controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; }
        .controls button { width: 60px; height: 60px; font-size: 20px; background-color: #333; color: white; border: none; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div class="controls">
        <button id="left">‚¨ÖÔ∏è</button>
        <button id="up">‚¨ÜÔ∏è</button>
        <button id="right">‚û°Ô∏è</button>
        <button id="down">‚¨áÔ∏è</button>
        <button id="shoot">üî´</button>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener("resize", resizeCanvas);
        resizeCanvas(); 

        // Player object
        const player = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            width: 30,
            height: 30,
            color: "blue",
            speed: 5,
            health: 100,
            ammo: 30,
            weapon: null,
            inventory: [] // Store up to 2 weapons
        };

        // Weapons (same as previous)
        const mythicSkyeAssaultRifle = {
            name: "Mythic Skye's Assault Rifle",
            damage: 25,
            fireRate: 300,
            ammoCapacity: 100,
            reloadTime: 2000,
            color: "#6B3FA0",
            type: "assault_rifle",
            rarity: "Mythic"
        };

        const goldPumpShotgun = {
            name: "Gold Pump Shotgun",
            damage: 100,
            fireRate: 1000,
            ammoCapacity: 5,
            reloadTime: 2500,
            color: "#FFD700",
            type: "shotgun",
            rarity: "Legendary"
        };

        const p90 = {
            name: "P90",
            damage: 20,
            fireRate: 200,
            ammoCapacity: 50,
            reloadTime: 1500,
            color: "#FFD700",
            type: "smg",
            rarity: "Legendary"
        };

        const shockwaveGrenades = {
            name: "Shockwave Grenades",
            damage: 0,
            fireRate: 0,
            ammoCapacity: 3,
            reloadTime: 1000,
            color: "#FF1493",
            type: "grenade",
            rarity: "Legendary"
        };

        const smg = {
            name: "SMG",
            damage: 15,
            fireRate: 400,
            ammoCapacity: 30,
            reloadTime: 1000,
            color: "#808080",
            type: "smg",
            rarity: "Common"
        };

        const pistol = {
            name: "Pistol",
            damage: 10,
            fireRate: 500,
            ammoCapacity: 15,
            reloadTime: 1200,
            color: "#808080",
            type: "pistol",
            rarity: "Common"
        };

        const revolver = {
            name: "Revolver",
            damage: 30,
            fireRate: 700,
            ammoCapacity: 6,
            reloadTime: 1500,
            color: "#808080",
            type: "revolver",
            rarity: "Common"
        };

        const ar = {
            name: "Assault Rifle",
            damage: 25,
            fireRate: 300,
            ammoCapacity: 30,
            reloadTime: 2000,
            color: "#808080",
            type: "ar",
            rarity: "Common"
        };

        const shotgun = {
            name: "Shotgun",
            damage: 40,
            fireRate: 800,
            ammoCapacity: 5,
            reloadTime: 2500,
            color: "#808080",
            type: "shotgun",
            rarity: "Common"
        };

        const randomCommonWeapon = [smg, pistol, revolver, ar, shotgun];
        const randomLegendaryWeapon = [goldPumpShotgun, p90, shockwaveGrenades];
        
        // Random item spawn function
        function spawnRandomItem() {
            let spawnChance = Math.random();
            let item = null;

            if (spawnChance < 0.8) { // 80% Common
                item = randomCommonWeapon[Math.floor(Math.random() * randomCommonWeapon.length)];
            } else { // 20% Legendary
                item = randomLegendaryWeapon[Math.floor(Math.random() * randomLegendaryWeapon.length)];
            }

            return {
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                item: item
            };
        }

        // Enemy object
        let enemyCount = 0;
        const enemies = [];

        // Boss Object
        const boss = {
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            width: 100,
            height: 100,
            health: 500,
            color: "purple",
            defeated: false,
            move() {
                const targetX = player.x - this.x;
                const targetY = player.y - this.y;
                const distance = Math.sqrt(targetX * targetX + targetY * targetY);
                const speed = 0.5; // Boss moves slower

                if (distance > 5) { // Only move if not too close
                    this.x += targetX / distance * speed;
                    this.y += targetY / distance * speed;
                }
            }
        };

        // Handle movement controls
        let keys = {};

        window.addEventListener("keydown", (e) => {
            keys[e.key] = true;
        });

        window.addEventListener("keyup", (e) => {
            keys[e.key] = false;
        });

        // Mobile Controls (Move player)
        document.getElementById("left").onclick = () => player.x -= player.speed;
        document.getElementById("up").onclick = () => player.y -= player.speed;
        document.getElementById("right").onclick = () => player.x += player.speed;
        document.getElementById("down").onclick = () => player.y += player.speed;

        // Check for weapon unlock
        function checkWeaponUnlock() {
            if (enemyCount >= 10 && !player.inventory.includes(goldPumpShotgun)) {
                player.inventory.push(goldPumpShotgun);
            }

            if (enemyCount >= 25 && !player.inventory.includes(mythicSkyeAssaultRifle)) {
                player.inventory.push(mythicSkyeAssaultRifle);
            }
        }

        // Enemy defeat
        function defeatEnemy() {
            enemyCount++;
            checkWeaponUnlock();

            // Spawn new enemy after one is defeated
            spawnEnemy();

            // Check if the player has defeated 100 enemies
            if (enemyCount >= 100) {
                // Display win message
                alert("You Win! You've defeated 100 enemies!");
                // Reset the game or stop the game loop
                cancelAnimationFrame(gameLoopId);
            }
        }

        // Spawn a new enemy
        function spawnEnemy() {
            const enemy = {
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                width: 30,
                height: 30,
                color: "red",
                move() {
                    const targetX = player.x - this.x;
                    const targetY = player.y - this.y;
                    const distance = Math.sqrt(targetX * targetX + targetY * targetY);
                    const speed = 2; // Normal enemy speed

                    if (distance > 5) { // Only move if not too close
                        this.x += targetX / distance * speed;
                        this.y += targetY / distance * speed;
                    }
                }
            };

            enemies.push(enemy);
        }

        // Main game logic
        function update() {
            // Move player
            if (keys["ArrowUp"]) player.y -= player.speed;
            if (keys["ArrowDown"]) player.y += player.speed;
            if (keys["ArrowLeft"]) player.x -= player.speed;
            if (keys["ArrowRight"]) player.x += player.speed;

            // Move enemies and bosses
            enemies.forEach(enemy => enemy.move());
            boss.move();

            // Collision detection for defeating enemies
            enemies.forEach((enemy, index) => {
                if (Math.abs(player.x - enemy.x) < player.width && Math.abs(player.y - enemy.y) < player.height) {
                    defeatEnemy();
                    enemies.splice(index, 1); // Remove defeated enemy
                }
            });

            // Random item spawning
            const randomItem = spawnRandomItem();
            items.push(randomItem);

            // Update the display
            draw();
        }

        // Drawing game state
        const items = [];

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw player
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // Draw enemies
            enemies.forEach(enemy => {
                ctx.fillStyle = enemy.color;
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
            });

            // Draw boss
            if (!boss.defeated) {
                ctx.fillStyle = boss.color;
                ctx.fillRect(boss.x, boss.y, boss.width, boss.height);
            }

            // Draw items
            items.forEach(item => {
                ctx.fillStyle = item.item.color;
                ctx.beginPath();
                ctx.arc(item.x, item.y, 10, 0, 2 * Math.PI);
                ctx.fill();
            });

            // Draw item names and rarity
            items.forEach(item => {
                ctx.fillStyle = "black";
                ctx.fillText(item.item.name, item.x + 10, item.y);
                ctx.fillText(item.item.rarity, item.x + 10, item.y + 10);
            });
        }

        // Game loop
        let gameLoopId;
        function gameLoop() {
            draw();
            update();
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        gameLoop(); // Start the game loop
    </script>
</body>
</html>
