<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Fighter</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; background: #87CEEB; }
        .controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; }
        .controls button { width: 60px; height: 60px; font-size: 20px; background-color: #333; color: white; border: none; border-radius: 10px; cursor: pointer; }
        .controls button:active { background-color: #555; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div class="controls">
        <button id="left">‚¨ÖÔ∏è</button>
        <button id="up">‚¨ÜÔ∏è</button>
        <button id="right">‚û°Ô∏è</button>
        <button id="down">‚¨áÔ∏è</button>
        <button id="pickup">üîΩ</button>
        <button id="drop">‚õî</button>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener("resize", resizeCanvas);
        resizeCanvas(); 

        // Player object
        const player = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            width: 30,
            height: 30,
            color: "blue",
            speed: 5,
            health: 100,
            ammo: 30,
            weapon: null,
            inventory: [] // Store up to 2 weapons
        };

        // Weapons
        const mythicSkyeAssaultRifle = {
            name: "Mythic Skye's Assault Rifle",
            damage: 25,
            fireRate: 300,
            ammoCapacity: 100,
            reloadTime: 2000,
            color: "#6B3FA0",
            type: "assault_rifle",
            rarity: "Mythic"
        };

        const goldPumpShotgun = {
            name: "Gold Pump Shotgun",
            damage: 100,
            fireRate: 1000,
            ammoCapacity: 5,
            reloadTime: 2500,
            color: "#FFD700",
            type: "shotgun",
            rarity: "Legendary"
        };

        const p90 = {
            name: "P90",
            damage: 20,
            fireRate: 200,
            ammoCapacity: 50,
            reloadTime: 1500,
            color: "#FFD700",
            type: "smg",
            rarity: "Legendary"
        };

        const shockwaveGrenades = {
            name: "Shockwave Grenades",
            damage: 0,
            fireRate: 0,
            ammoCapacity: 3,
            reloadTime: 1000,
            color: "#FF1493",
            type: "grenade",
            rarity: "Legendary"
        };

        const smg = {
            name: "SMG",
            damage: 15,
            fireRate: 400,
            ammoCapacity: 30,
            reloadTime: 1000,
            color: "#808080",
            type: "smg",
            rarity: "Common"
        };

        const pistol = {
            name: "Pistol",
            damage: 10,
            fireRate: 500,
            ammoCapacity: 15,
            reloadTime: 1200,
            color: "#808080",
            type: "pistol",
            rarity: "Common"
        };

        const revolver = {
            name: "Revolver",
            damage: 30,
            fireRate: 700,
            ammoCapacity: 6,
            reloadTime: 1500,
            color: "#808080",
            type: "revolver",
            rarity: "Common"
        };

        const ar = {
            name: "Assault Rifle",
            damage: 25,
            fireRate: 300,
            ammoCapacity: 30,
            reloadTime: 2000,
            color: "#808080",
            type: "ar",
            rarity: "Common"
        };

        const shotgun = {
            name: "Shotgun",
            damage: 40,
            fireRate: 800,
            ammoCapacity: 5,
            reloadTime: 2500,
            color: "#808080",
            type: "shotgun",
            rarity: "Common"
        };

        const randomCommonWeapon = [smg, pistol, revolver, ar, shotgun];
        const randomLegendaryWeapon = [goldPumpShotgun, p90, shockwaveGrenades];

        // Random item spawn function
        let lastSpawnTime = 0;
        const spawnCooldown = 2000; // 2 seconds cooldown for item spawn
        let items = [];

        function spawnRandomItem() {
            let spawnChance = Math.random();
            let item = null;

            if (spawnChance < 0.8) { // 80% Common
                item = randomCommonWeapon[Math.floor(Math.random() * randomCommonWeapon.length)];
            } else { // 20% Legendary
                item = randomLegendaryWeapon[Math.floor(Math.random() * randomLegendaryWeapon.length)];
            }

            return {
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                item: item
            };
        }

        function trySpawnItem() {
            const currentTime = Date.now();
            if (currentTime - lastSpawnTime >= spawnCooldown) {
                if (items.length < 5) { // Limit items on the screen
                    items.push(spawnRandomItem());
                }
                lastSpawnTime = currentTime;
            }
        }

        // Handle movement controls
        let keys = {};

        window.addEventListener("keydown", (e) => {
            keys[e.key] = true;
        });

        window.addEventListener("keyup", (e) => {
            keys[e.key] = false;
        });

        // Mobile Controls (Move player)
        document.getElementById("left").onclick = () => player.x -= player.speed;
        document.getElementById("up").onclick = () => player.y -= player.speed;
        document.getElementById("right").onclick = () => player.x += player.speed;
        document.getElementById("down").onclick = () => player.y += player.speed;

        // Pickup and Drop Weapons on Mobile Controls
        document.getElementById("pickup").onclick = () => pickupWeapon();
        document.getElementById("drop").onclick = () => dropWeapon();

        // Keyboard controls for pickup/drop
        window.addEventListener("keydown", (e) => {
            if (e.key === "e") { // Pickup Weapon with 'E'
                pickupWeapon();
            } else if (e.key === "q") { // Drop Weapon with 'Q'
                dropWeapon();
            }
        });

        // Pickup Weapon function
        function pickupWeapon() {
            for (let i = 0; i < items.length; i++) {
                const item = items[i];
                const distance = Math.sqrt((player.x - item.x) ** 2 + (player.y - item.y) ** 2);
                if (distance < 50) { // If close enough to pick up
                    if (player.inventory.length < 2) {
                        player.inventory.push(item.item);
                        items.splice(i, 1); // Remove item from the map after pickup
                        console.log("Weapon picked up:", item.item.name);
                        break;
                    } else {
                        console.log("Inventory full!");
                    }
                }
            }
        }

        // Drop Weapon function
        function dropWeapon() {
            if (player.inventory.length > 0) {
                const weaponToDrop = player.inventory.pop();
                items.push({
                    x: player.x,
                    y: player.y,
                    item: weaponToDrop
                });
                console.log("Weapon dropped:", weaponToDrop.name);
            } else {
                console.log("No weapon to drop!");
            }
        }

        // Render function
        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw Player
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x - player.width / 2, player.y - player.height / 2, player.width, player.height);

            // Draw Inventory
            ctx.font = "20px Arial";
            ctx.fillStyle = "black";
            ctx.fillText("Inventory: " + player.inventory.map(w => w.name).join(", "), 10, 30);

            // Draw Items on ground
            items.forEach(item => {
                ctx.beginPath();
                ctx.arc(item.x, item.y, 15, 0, Math.PI * 2);
                ctx.fillStyle = item.item.color;
                ctx.fill();
            });

            // Call requestAnimationFrame
            requestAnimationFrame(render);
        }

        render(); // Start the rendering loop
    </script>
</body>
</html>
